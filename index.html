<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JSON Formatify - Best Online JSON Formatter & Validator</title>
    <meta name="description" content="Instantly format, validate, beautify, minify, and repair JSON data with JSON Formatify. Free online JSON tool with tree view and dark mode.">
    <meta name="keywords" content="json formatter, json validator, online json tool, json beautifier, json minifier, json fixer, free json editor">
    <meta name="robots" content="index, follow">
    <meta name="author" content="JSON Formatify">
    <meta name="revisit-after" content="1 days">
    <link rel="canonical" href="https://jsonformatify.com">
    <style>
        :root {
            --bg-gradient: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            --logo-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --button-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --button-hover-gradient: linear-gradient(135deg, #5a67d8 0%, #6b46c1 100%);
            --pane-bg: #fff;
            --text-color: #333;
            --output-bg: #fafafa;
            --border-color: #ddd;
            --error-color: #d32f2f;
            --success-color: #28a745;
            --highlight-bg: #fff9c4;
            --tree-string: #d32f2f;
            --tree-number: #1976d2;
            --tree-boolean: #7b1fa2;
            --tree-null: #616161;
            --toggle-color: #667eea;
            --button-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            --button-hover-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
        }

        [data-theme="dark"] {
            --bg-gradient: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            --logo-gradient: linear-gradient(135deg, #0f3460 0%, #1a1a2e 100%);
            --button-gradient: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);
            --button-hover-gradient: linear-gradient(135deg, #4338ca 0%, #6d28d9 100%);
            --pane-bg: #2d2d2d;
            --text-color: #e0e0e0;
            --output-bg: #1a1a1a;
            --border-color: #444;
            --error-color: #dc3545;
            --success-color: #198754;
            --highlight-bg: #333300;
            --tree-string: #ff6b6b;
            --tree-number: #4dabf7;
            --tree-boolean: #a855f7;
            --tree-null: #9ca3af;
            --toggle-color: #4f46e5;
            --button-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
            --button-hover-shadow: 0 4px 8px rgba(0, 0, 0, 0.4);
        }

        body {
            margin: 0;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            font-family: Arial, sans-serif;
            background: var(--bg-gradient);
            color: var(--text-color);
            transition: background 0.3s ease, color 0.3s ease;
        }

        nav {
            background: var(--logo-gradient);
            color: white;
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex: none;
            transition: background 0.3s ease;
        }

        .logo-content {
            display: flex;
            flex-direction: column;
        }

        .logo-text {
            font-size: 24px;
            font-weight: bold;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);
            margin: 0;
        }

        .subtitle {
            font-size: 14px;
            font-style: italic;
            margin-top: 2px;
            opacity: 0.9;
        }

        .nav-links {
            display: flex;
            gap: 15px;
        }

        .nav-links a {
            color: white;
            text-decoration: none;
            font-size: 16px;
            padding: 8px 12px;
            border-radius: 4px;
            transition: background 0.3s ease;
        }

        .nav-links a:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .theme-toggle {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 12px;
            color: white;
        }

        .theme-toggle input[type="checkbox"] {
            width: 18px;
            height: 18px;
            accent-color: var(--toggle-color);
        }

        .json-formatter-container {
            font-family: Arial, sans-serif;
            display: flex;
            flex: 1;
            margin: 0;
            padding: 10px;
            box-sizing: border-box;
            background: transparent;
            isolation: isolate;
            transition: background 0.3s ease;
        }

        .json-formatter-container .pane {
            flex: 1;
            display: flex;
            flex-direction: column;
            margin: 0 5px;
            background-color: var(--pane-bg);
            border-radius: 8px;
            padding: 10px;
            color: var(--text-color);
            transition: background-color 0.3s ease, color 0.3s ease;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .json-formatter-container textarea {
            width: 100%;
            height: 80%;
            resize: none;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            padding: 8px;
            box-sizing: border-box;
            background-color: var(--pane-bg);
            color: var(--text-color);
            transition: border-color 0.3s ease, background-color 0.3s ease, color 0.3s ease;
        }

        .json-formatter-container .buttons {
            margin-top: 8px;
            text-align: center;
            display: flex;
            gap: 6px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .json-formatter-container button {
            padding: 6px 8px;
            margin: 0 2px;
            border: none;
            border-radius: 4px;
            background: var(--button-gradient);
            color: #fff;
            cursor: pointer;
            font-size: 12px;
            min-width: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            box-shadow: var(--button-shadow);
        }

        .json-formatter-container button:hover {
            background: var(--button-hover-gradient);
            box-shadow: var(--button-hover-shadow);
            transform: translateY(-1px);
        }

        .json-formatter-container #output {
            height: 70%;
            overflow-y: auto;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            padding: 8px;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            background-color: var(--output-bg);
            color: var(--text-color);
            white-space: pre-wrap;
            transition: border-color 0.3s ease, background-color 0.3s ease, color 0.3s ease;
        }

        .json-formatter-container .controls {
            margin-bottom: 8px;
            display: flex;
            gap: 6px;
            flex-wrap: wrap;
            align-items: center;
        }

        .json-formatter-container .controls input {
            flex: 1;
            padding: 6px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            font-size: 12px;
            background-color: var(--pane-bg);
            color: var(--text-color);
            transition: border-color 0.3s ease, background-color 0.3s ease, color 0.3s ease;
        }

        .json-formatter-container .controls select {
            padding: 6px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            font-size: 12px;
            background-color: var(--pane-bg);
            color: var(--text-color);
            cursor: pointer;
            transition: border-color 0.3s ease, background-color 0.3s ease, color 0.3s ease;
        }

        .json-formatter-container .controls select:focus {
            outline: none;
            border-color: var(--toggle-color);
        }

        .json-formatter-container .tree-node {
            margin-left: 15px;
            list-style: none;
        }

        .json-formatter-container .tree-node.collapsed > .tree-content {
            display: none;
        }

        .json-formatter-container .tree-node .toggle {
            display: inline-block;
            width: 15px;
            text-align: center;
            margin-right: 5px;
            color: var(--toggle-color);
            cursor: pointer;
            user-select: none;
            font-weight: bold;
            transition: color 0.3s ease;
            font-size: 12px;
        }

        .json-formatter-container .tree-node.collapsed .toggle::before {
            content: '>';
        }

        .json-formatter-container .tree-node:not(.collapsed) .toggle::before {
            content: '>';
            display: inline-block;
            transform: rotate(90deg);
        }

        .json-formatter-container .tree-node > span:not(.toggle) {
            color: var(--text-color);
            transition: color 0.3s ease;
        }

        .json-formatter-container .tree-content {
            padding-left: 10px;
        }

        .json-formatter-container .tree-node li {
            padding: 2px 0;
        }

        .json-formatter-container .tree-node li.string {
            color: var(--tree-string);
        }

        .json-formatter-container .tree-node li.number {
            color: var(--tree-number);
        }

        .json-formatter-container .tree-node li.boolean {
            color: var(--tree-boolean);
        }

        .json-formatter-container .tree-node li.null {
            color: var(--tree-null);
        }

        .json-formatter-container .tree-node li.leaf {
            display: block;
            margin-right: 10px;
            margin-bottom: 2px;
        }

        .json-formatter-container .highlight {
            background-color: var(--highlight-bg);
        }

        .json-formatter-container .error, .json-formatter-container .success {
            margin-bottom: 8px;
            text-align: center;
            font-size: 12px;
        }

        .json-formatter-container .error {
            color: var(--error-color);
        }

        .json-formatter-container .success {
            color: var(--success-color);
        }

        h3 {
            color: var(--text-color);
            transition: color 0.3s ease;
        }

        .json-formatter-container .pane {
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        [data-theme="dark"] .json-formatter-container .pane {
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
        }

        footer {
            background: var(--logo-gradient);
            color: white;
            text-align: center;
            padding: 20px;
            margin-top: auto;
        }

        footer a {
            color: white;
            text-decoration: none;
        }

        footer a:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav>
        <div class="logo-content">
            <div class="logo-text">jsonformatify.com</div>
            <div class="subtitle">Best JSON Formatter and Validator</div>
        </div>
        <div class="nav-links">
            <a href="index.html">Home</a>
            <a href="about.html">About</a>
            <a href="faq.html">FAQ</a>
            <div class="theme-toggle">
                <input type="checkbox" id="darkModeToggle">
                <label for="darkModeToggle">Dark Mode</label>
            </div>
        </div>
    </nav>

    <!-- Tool Container -->
    <div class="json-formatter-container">
        <div class="pane">
            <h3>Input JSON</h3>
            <textarea id="inputJson" placeholder="Paste your JSON here..."></textarea>
            <div class="buttons">
                <button onclick="formatJson()">Format</button>
                <button onclick="compactJson()">Compact</button>
                <button onclick="beautifyJson()">Beautify</button>
                <button onclick="correctJson()">Fix JSON</button>
            </div>
            <div id="inputError" class="error"></div>
        </div>
        <div class="pane">
            <h3>Formatted JSON</h3>
            <div id="outputError" class="error"></div>
            <div id="outputSuccess" class="success"></div>
            <div class="controls">
                <input id="searchInput" type="text" placeholder="Search JSON...">
                <button onclick="searchTree()">Search</button>
                <button onclick="validateJson()">Validate</button>
                <button onclick="copyJson()">Copy</button>
                <button onclick="downloadJson()">Download</button>
                <select id="viewSelect" onchange="changeView()">
                    <option value="tree">Tree View</option>
                    <option value="indentation">Indentation View</option>
                </select>
                <div id="treeControls" style="display: none;">
                    <button onclick="collapseAll()">Collapse All</button>
                    <button onclick="expandAll()">Expand All</button>
                </div>
            </div>
            <div id="output"></div>
        </div>
    </div>

    <!-- Footer -->
    <footer>
        <p>&copy; 2025 JSON Formatify. All rights reserved. | <a href="#top">Back to Top</a></p>
    </footer>

    <script>
        let parsedJson = null;
        let formattedJson = '';

        const darkModeToggle = document.getElementById('darkModeToggle');
        const currentTheme = localStorage.getItem('theme');
        const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;

        if (currentTheme === 'dark' || (!currentTheme && prefersDark)) {
            document.documentElement.setAttribute('data-theme', 'dark');
            darkModeToggle.checked = true;
        }

        darkModeToggle.addEventListener('change', () => {
            if (darkModeToggle.checked) {
                document.documentElement.setAttribute('data-theme', 'dark');
                localStorage.setItem('theme', 'dark');
            } else {
                document.documentElement.setAttribute('data-theme', 'light');
                localStorage.setItem('theme', 'light');
            }
        });

        function formatJson() {
            const input = document.getElementById('inputJson').value;
            const inputError = document.getElementById('inputError');

            inputError.textContent = '';

            try {
                const parsed = JSON.parse(input);
                document.getElementById('inputJson').value = JSON.stringify(parsed, null, 2);
                updateOutput(parsed);
            } catch (e) {
                inputError.textContent = 'Invalid JSON: ' + e.message;
            }
        }

        function compactJson() {
            const input = document.getElementById('inputJson').value;
            const inputError = document.getElementById('inputError');

            inputError.textContent = '';

            try {
                const parsed = JSON.parse(input);
                document.getElementById('inputJson').value = JSON.stringify(parsed);
                updateOutput(parsed);
            } catch (e) {
                inputError.textContent = 'Invalid JSON: ' + e.message;
            }
        }

        function beautifyJson() {
            const input = document.getElementById('inputJson').value;
            const inputError = document.getElementById('inputError');
            const output = document.getElementById('output');
            const outputError = document.getElementById('outputError');
            const outputSuccess = document.getElementById('outputSuccess');

            inputError.textContent = '';
            outputError.textContent = '';
            outputSuccess.textContent = '';
            output.innerHTML = '';

            try {
                parsedJson = JSON.parse(input);
                formattedJson = JSON.stringify(parsedJson, null, 2);
                renderOutput();
            } catch (e) {
                inputError.textContent = 'Invalid JSON: ' + e.message;
                parsedJson = null;
                formattedJson = '';
            }
        }

        function correctJson() {
            const input = document.getElementById('inputJson').value;
            const inputError = document.getElementById('inputError');
            const output = document.getElementById('output');
            const outputError = document.getElementById('outputError');
            const outputSuccess = document.getElementById('outputSuccess');

            inputError.textContent = '';
            outputError.textContent = '';
            outputSuccess.textContent = '';
            output.innerHTML = '';

            try {
                parsedJson = JSON.parse(input);
                formattedJson = JSON.stringify(parsedJson, null, 2);
                document.getElementById('inputJson').value = formattedJson;
                renderOutput();
            } catch (e) {
                try {
                    let corrected = input.trim();
                    corrected = corrected.replace(/\/\/.*$/gm, '');
                    corrected = corrected.replace(/\/\*[\s\S]*?\*\//g, '');
                    corrected = corrected.replace(/([{,]\s*)(\w+)(?=\s*:)/g, '$1"$2"');
                    corrected = corrected.replace(/'/g, '"');
                    corrected = corrected.replace(/:(\s*)(\w+)(?=\s*[,}])/g, ':$1"$2"');
                    corrected = corrected.replace(/\b(True|False|TRUE|FALSE|Null|NULL)\b/g, (match) => {
                        const lower = match.toLowerCase();
                        return lower === 'true' || lower === 'false' ? lower : 'null';
                    });
                    corrected = corrected.replace(/,(\s*[}\]])/g, '$1');
                    corrected = corrected.replace(/([}\]"'])(?=\s*"[^"]*"\s*:)/g, '$1,');
                    corrected = corrected.replace(/([}\]"'])(?=\s*\[)/g, '$1,');
                    corrected = corrected.replace(/([}\]"'])(?=\s*{)/g, '$1,');
                    corrected = corrected.replace(/:(\s*)0+(\d+\.?\d*)/g, ':$1$2');
                    corrected = corrected.replace(/(\d)\.(\d*)\.(\d*)/g, '$1.$2$3');
                    corrected = corrected.replace(/\\[^"\\/bfnrtu]/g, '\\\\');
                    corrected = corrected.replace(/("\w+")(\s*[{["])/g, '$1:$2');
                    corrected = corrected.replace(/:+/g, ':');
                    corrected = corrected.replace(/"([^"]*?)(\p{Extended_Pictographic}|\p{Emoji_Presentation})([^"]*?)"/gu, (match, p1, emoji, p2) => {
                        return `"${p1}\\u${emoji.codePointAt(0).toString(16).padStart(4, '0')}${p2}"`;
                    });
                    corrected = addMissingBraces(corrected);
                    corrected = corrected.replace(/\s+/g, ' ').trim();
                    parsedJson = JSON.parse(corrected);
                    formattedJson = JSON.stringify(parsedJson, null, 2);
                    document.getElementById('inputJson').value = formattedJson;
                    renderOutput();
                } catch (correctionError) {
                    inputError.textContent = 'Unable to correct JSON: ' + correctionError.message;
                    parsedJson = null;
                    formattedJson = '';
                }
            }
        }

        function validateJson() {
            const input = document.getElementById('inputJson').value;
            const outputError = document.getElementById('outputError');
            const outputSuccess = document.getElementById('outputSuccess');
            const output = document.getElementById('output');

            outputError.textContent = '';
            outputSuccess.textContent = '';
            output.innerHTML = '';

            try {
                parsedJson = JSON.parse(input);
                formattedJson = JSON.stringify(parsedJson, null, 2);
                outputSuccess.textContent = 'JSON is valid!';
                renderOutput();
            } catch (e) {
                parsedJson = null;
                formattedJson = '';
                outputError.textContent = 'Invalid JSON: ' + e.message;
            }
        }

        function copyJson() {
            const outputError = document.getElementById('outputError');
            const outputSuccess = document.getElementById('outputSuccess');
            const output = document.getElementById('output');

            outputError.textContent = '';
            outputSuccess.textContent = '';
            output.innerHTML = '';

            if (!parsedJson) {
                outputError.textContent = 'No valid JSON to copy.';
                return;
            }

            navigator.clipboard.writeText(formattedJson).then(() => {
                outputSuccess.textContent = 'JSON copied to clipboard!';
                renderOutput();
            }).catch(() => {
                outputError.textContent = 'Failed to copy JSON.';
                renderOutput();
            });
        }

        function downloadJson() {
            const outputError = document.getElementById('outputError');
            const outputSuccess = document.getElementById('outputSuccess');
            const output = document.getElementById('output');

            outputError.textContent = '';
            outputSuccess.textContent = '';
            output.innerHTML = '';

            if (!parsedJson) {
                outputError.textContent = 'No valid JSON to download.';
                return;
            }

            const blob = new Blob([formattedJson], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'formatted.json';
            a.click();
            URL.revokeObjectURL(url);
            outputSuccess.textContent = 'JSON downloaded!';
            renderOutput();
        }

        function addMissingBraces(input) {
            let openBraces = 0;
            let openBrackets = 0;
            let result = input;

            for (let i = 0; i < input.length; i++) {
                if (input[i] === '{') openBraces++;
                else if (input[i] === '}') openBraces--;
                else if (input[i] === '[') openBrackets++;
                else if (input[i] === ']') openBrackets--;
            }

            while (openBraces > 0) {
                result += '}';
                openBraces--;
            }

            while (openBrackets > 0) {
                result += ']';
                openBrackets--;
            }

            return result;
        }

        function updateOutput(inputJson) {
            const output = document.getElementById('output');
            const outputError = document.getElementById('outputError');
            const outputSuccess = document.getElementById('outputSuccess');

            outputError.textContent = '';
            outputSuccess.textContent = '';
            output.innerHTML = '';

            try {
                parsedJson = inputJson || JSON.parse(document.getElementById('inputJson').value);
                formattedJson = JSON.stringify(parsedJson, null, 2);
                renderOutput();
            } catch (e) {
                parsedJson = null;
                formattedJson = '';
                outputError.textContent = 'Invalid JSON: ' + e.message;
            }
        }

        function renderOutput() {
            const output = document.getElementById('output');
            const outputError = document.getElementById('outputError');
            const outputSuccess = document.getElementById('outputSuccess');
            const treeControls = document.getElementById('treeControls');
            const view = document.getElementById('viewSelect').value;

            treeControls.style.display = view === 'tree' ? 'flex' : 'none';

            if (!parsedJson) {
                if (!outputError.textContent && !outputSuccess.textContent) {
                    outputError.textContent = 'No valid JSON to display.';
                }
                return;
            }

            output.innerHTML = '';

            if (view === 'tree') {
                renderTreeView(parsedJson, output);
            } else if (view === 'indentation') {
                output.textContent = formattedJson;
            }
        }

        function changeView() {
            if (!parsedJson) return;
            renderOutput();
        }

        function collapseAll() {
            document.querySelectorAll('.tree-node').forEach(node => {
                node.classList.add('collapsed');
            });
        }

        function expandAll() {
            document.querySelectorAll('.tree-node').forEach(node => {
                node.classList.remove('collapsed');
            });
        }

        function renderTreeView(data, parentElement) {
            parentElement.innerHTML = '';
            const ul = document.createElement('ul');
            ul.className = 'tree-node';
            if (data !== null && typeof data === 'object') {
                const li = document.createElement('li');
                li.className = 'tree-node';
                const toggle = document.createElement('span');
                toggle.className = 'toggle';
                toggle.onclick = () => toggleNode(toggle, li);
                li.appendChild(toggle);
                const keySpan = document.createElement('span');
                keySpan.textContent = Array.isArray(data) ? '[Array]' : '{Object}';
                keySpan.dataset.path = '';
                li.appendChild(keySpan);
                const content = document.createElement('div');
                content.className = 'tree-content';
                li.appendChild(content);
                renderNode(data, content, '');
                ul.appendChild(li);
            } else {
                const li = document.createElement('li');
                li.className = 'leaf';
                const keyValueSpan = document.createElement('span');
                keyValueSpan.textContent = JSON.stringify(data);
                keyValueSpan.dataset.path = '';
                if (typeof data === 'string') li.className += ' string';
                else if (typeof data === 'number') li.className += ' number';
                else if (typeof data === 'boolean') li.className += ' boolean';
                else if (data === null) li.className += ' null';
                li.appendChild(keyValueSpan);
                ul.appendChild(li);
            }
            parentElement.appendChild(ul);
        }

        function renderNode(data, parentElement, path = '') {
            if (Array.isArray(data)) {
                data.forEach((item, index) => {
                    const li = document.createElement('li');
                    if (item !== null && typeof item === 'object') {
                        li.className = 'tree-node';
                        const toggle = document.createElement('span');
                        toggle.className = 'toggle';
                        toggle.onclick = () => toggleNode(toggle, li);
                        li.appendChild(toggle);
                        const keySpan = document.createElement('span');
                        keySpan.textContent = `[${index}]`;
                        keySpan.dataset.path = `${path}[${index}]`;
                        li.appendChild(keySpan);
                        const content = document.createElement('div');
                        content.className = 'tree-content';
                        li.appendChild(content);
                        renderNode(item, content, `${path}[${index}]`);
                    } else {
                        li.className = 'leaf';
                        const keyValueSpan = document.createElement('span');
                        keyValueSpan.textContent = `[${index}]: ${JSON.stringify(item)}`;
                        keyValueSpan.dataset.path = `${path}[${index}]`;
                        if (typeof item === 'string') li.className += ' string';
                        else if (typeof item === 'number') li.className += ' number';
                        else if (typeof item === 'boolean') li.className += ' boolean';
                        else if (item === null) li.className += ' null';
                        li.appendChild(keyValueSpan);
                    }
                    parentElement.appendChild(li);
                });
            } else if (data !== null && typeof data === 'object') {
                Object.keys(data).forEach(key => {
                    const li = document.createElement('li');
                    if (data[key] !== null && typeof data[key] === 'object') {
                        li.className = 'tree-node';
                        const toggle = document.createElement('span');
                        toggle.className = 'toggle';
                        toggle.onclick = () => toggleNode(toggle, li);
                        li.appendChild(toggle);
                        const keySpan = document.createElement('span');
                        keySpan.textContent = `${key}`;
                        keySpan.dataset.path = path ? `${path}.${key}` : key;
                        li.appendChild(keySpan);
                        const content = document.createElement('div');
                        content.className = 'tree-content';
                        li.appendChild(content);
                        renderNode(data[key], content, path ? `${path}.${key}` : key);
                    } else {
                        li.className = 'leaf';
                        const keyValueSpan = document.createElement('span');
                        keyValueSpan.textContent = `${key}: ${JSON.stringify(data[key])}`;
                        keyValueSpan.dataset.path = path ? `${path}.${key}` : key;
                        if (typeof data[key] === 'string') li.className += ' string';
                        else if (typeof data[key] === 'number') li.className += ' number';
                        else if (typeof data[key] === 'boolean') li.className += ' boolean';
                        else if (data[key] === null) li.className += ' null';
                        li.appendChild(keyValueSpan);
                    }
                    parentElement.appendChild(li);
                });
            }
        }

        function toggleNode(toggle, li) {
            const isCollapsed = li.classList.contains('collapsed');
            li.classList.toggle('collapsed', !isCollapsed);
        }

        function searchTree() {
            const searchInput = document.getElementById('searchInput').value.toLowerCase();
            const output = document.getElementById('output');
            const outputError = document.getElementById('outputError');
            const outputSuccess = document.getElementById('outputSuccess');
            const view = document.getElementById('viewSelect').value;

            if (!parsedJson) {
                outputError.textContent = 'Please beautify or correct JSON first.';
                outputError.style.color = '#d32f2f';
                return;
            }

            outputError.textContent = '';
            outputSuccess.textContent = '';
            document.querySelectorAll('.highlight').forEach(el => el.classList.remove('highlight'));
            document.querySelectorAll('.tree-node.collapsed').forEach(node => {
                node.classList.remove('collapsed');
            });

            if (!searchInput || view !== 'tree') {
                return;
            }

            const matches = document.querySelectorAll('.tree-node span[data-path], .leaf span[data-path]');
            let matchFound = false;
            matches.forEach(element => {
                const text = element.textContent.toLowerCase();
                const path = element.dataset.path;
                if (text.includes(searchInput) || (path && path.toLowerCase().includes(searchInput))) {
                    element.classList.add('highlight');
                    let parent = element.closest('.tree-node');
                    while (parent) {
                        parent.classList.remove('collapsed');
                        parent = parent.parentElement.closest('.tree-node');
                    }
                    matchFound = true;
                }
            });

            if (!matchFound) {
                outputError.textContent = 'No matches found.';
                outputError.style.color = '#d32f2f';
            }
        }

        document.getElementById('inputJson').addEventListener('input', function() {
            const input = this.value;
            const inputError = document.getElementById('inputError');
            const outputError = document.getElementById('outputError');
            const outputSuccess = document.getElementById('outputSuccess');

            inputError.textContent = '';
            outputError.textContent = '';
            outputSuccess.textContent = '';

            try {
                const parsed = JSON.parse(input);
                updateOutput(parsed);
            } catch (e) {
                inputError.textContent = 'Invalid JSON: ' + e.message;
                parsedJson = null;
                formattedJson = '';
                document.getElementById('output').innerHTML = '';
            }
        });

        document.getElementById('searchInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                searchTree();
            }
        });
    </script>
</body>
</html>
